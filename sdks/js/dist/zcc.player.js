!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Player=e():(t.ZCC=t.ZCC||{},t.ZCC.Player=e())}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=41)}({40:function(t,e,n){"use strict";function i(t,e){this.init(t,e)}i.prototype.init=function(t,e){this.option=Object.assign({},{encoding:"16bitInt",channels:1,sampleRate:8e3,flushingTime:1e3},t),this.samples=new Float32Array,this.flush=this.flush.bind(this),this.interval=setInterval(this.flush,this.option.flushingTime),this.maxValue=this.getMaxValue(),this.typedArray=this.getTypedArray(),this.onendedCallback=e,this.feedCounter=0,this.createContext()},i.prototype.webAudioTouchUnlock=function(t){return new Promise(function(e,n){if("suspended"===t.state&&"ontouchstart"in window){var i=function i(){t.resume().then(function(){document.body.removeEventListener("touchstart",i),document.body.removeEventListener("touchend",i),e(!0)},function(t){n(t)})};document.body.addEventListener("touchstart",i,!1),document.body.addEventListener("touchend",i,!1)}else e(!1)})},i.prototype.getMaxValue=function(){var t={"8bitInt":128,"16bitInt":32768,"32bitInt":2147483648,"32bitFloat":1};return t[this.option.encoding]?t[this.option.encoding]:t["16bitInt"]},i.prototype.getTypedArray=function(){var t={"8bitInt":Int8Array,"16bitInt":Int16Array,"32bitInt":Int32Array,"32bitFloat":Float32Array};return t[this.option.encoding]?t[this.option.encoding]:t["16bitInt"]},i.prototype.createContext=function(){this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.webAudioTouchUnlock(this.audioCtx).then(function(){this.gainNode=this.audioCtx.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioCtx.destination),this.startTime=this.audioCtx.currentTime}.bind(this),function(t){console.error(t)})},i.prototype.isTypedArray=function(t){return t.byteLength&&t.buffer&&t.buffer.constructor===ArrayBuffer},i.prototype.feed=function(t){if(!this.muted&&this.isTypedArray(t)){t=this.getFormatedValue(t);var e=new Float32Array(this.samples.length+t.length);e.set(this.samples,0),e.set(t,this.samples.length),this.samples=e,this.feedCounter++}},i.prototype.getFormatedValue=function(t){t=new this.typedArray(t.buffer);var e,n=new Float32Array(t.length);for(e=0;e<t.length;e++)n[e]=t[e]/this.maxValue;return n},i.prototype.volume=function(t){this.gainNode.gain.value=t},i.prototype.destroy=function(){this.interval&&clearInterval(this.interval),this.samples=new Float32Array,this.feedCounter=0,this.audioCtx.close(),this.audioCtx=null},i.prototype.flush=function(){var t=this;if(this.samples.length){var e,n,i,o,r,s=this.audioCtx.createBufferSource(),a=this.samples.length/this.option.channels,u=this.audioCtx.createBuffer(this.option.channels,a,this.option.sampleRate);for(n=0;n<this.option.channels;n++)for(e=u.getChannelData(n),i=n,r=50,o=0;o<a;o++)e[o]=this.samples[i],o<50&&(e[o]=e[o]*o/50),o>=a-51&&(e[o]=e[o]*r--/50),i+=this.option.channels;this.startTime<this.audioCtx.currentTime&&(this.startTime=this.audioCtx.currentTime),s.buffer=u,s.connect(this.gainNode),s.start(this.startTime);var h=this.feedCounter;s.onended=function(){t.onendedCallback&&t.onendedCallback.apply(t,[h])},this.startTime+=u.duration,this.samples=new Float32Array,this.feedCounter=0}},i.prototype.mute=function(t){this.muted=t},i.prototype.setSampleRate=function(t){this.option.sampleRate=t},t.exports=i},41:function(t,e,n){"use strict";var i=n(40);t.exports=i}})});